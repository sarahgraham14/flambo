"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{"default":e}};Object.defineProperty(exports,"__esModule",{value:!0});const fs_1=require("fs"),Updater_1=__importDefault(require("./Updater")),path_1=require("path"),Format_1=__importDefault(require("./Format"));class Storage{reference;update;path;constructor(e,t){this.path=e,this.reference=(0,Format_1["default"])({current:t},this.parse()),this.update=(0,Updater_1["default"])(this.reference,e=>this.value=e)}get value(){return(0,Format_1["default"])(this.reference,this.parse()).current}set value(e){this.reference.current=e,(0,fs_1.writeFileSync)(this.path,JSON.stringify(this.reference))}parse(){(0,fs_1.existsSync)(this.path)||this.create();var e=(0,fs_1.readFileSync)(this.path,{encoding:"utf-8"});return JSON.parse(e||"{}")}create(){(0,fs_1.existsSync)(this.path)||((0,fs_1.mkdirSync)((0,path_1.dirname)(this.path),{recursive:!0}),(0,fs_1.writeFileSync)(this.path,"{}"))}}exports["default"]=Storage;
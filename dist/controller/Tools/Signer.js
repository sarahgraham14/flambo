"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class Signer{encryptor;constructor(r){this.encryptor=r}sign(r){r=btoa(JSON.stringify({payload:r}));return r+"."+this.encryptor.sign(r,"base64")}verify(r){var[r,e]=r.split("."),e=Buffer.from(e,"base64");if(this.encryptor.verify(r,e))return JSON.parse(atob(r)).payload;throw new Error("Invalid signature")}}exports["default"]=Signer;